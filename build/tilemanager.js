(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["spriteentity"],function(e){var n,r,i;return n=function(e){function n(e){n.__super__.constructor.call(this,e),this.row=e.row,this.col=e.col,this.layers=[null,null,null,null,null]}return t(n,e),n.prototype.addTileLayer=function(e,t){var n,r;t=t||e.layer,r=this.layers[t]!=null;if(r&&this.layers[t].name===e.name){log.debug("You're trying to add the same layer");return}return r&&this.layers[t].destroy(),this.layers[t]=e,n=this.addEntityToQuadspace(e),n.attr("shape",this.shape),n.attr("draw_shape",!1)},n.prototype.update=function(e){var t,r,i,s,o;n.__super__.update.call(this,e),s=this.layers,o=[];for(r=0,i=s.length;r<i;r++)t=s[r],t!=null?o.push(t.update(e)):o.push(void 0);return o},n.prototype.draw=function(e){var t,r,i,s,o;n.__super__.draw.call(this,e),s=this.layers,o=[];for(r=0,i=s.length;r<i;r++)t=s[r],t!=null?o.push(t.draw(e)):o.push(void 0);return o},n}(e),r=function(e){function n(e){n.__super__.constructor.call(this,e),this.name=e.name!=null?e.name:""+this.id,this.layer=e.layer!=null?e.layer:0,this.on("SELECTED",function(){return this.attr("glow",!0),this.attr("glow_color","blue"),this.attr("draw_shape",!0),this.attr("stroke_color","white"),Hal.tween(this,"line_width",200,1,14.5,5)}),this.on("DESELECTED",function(){return this.attr("line_width",1),this.attr("glow",!1),this.attr("draw_shape",!1)})}return t(n,e),n.prototype.destroy=function(e){return e==null&&(e=!0),log.debug("destroying myself"),log.debug(this),this.parent.layers[this.layer]=null,n.__super__.destroy.call(this,e)},n}(e),i=function(){function e(e,t,n){var r=this;this.tilew=e,this.tileh=t,n==null&&(n=""),this.TilesByID={},this.TilesByName={},this._id=0,Hal.on("TILE_MNGR_NEW_TILE",function(e){return r.add(e)}),Hal.on("TILE_MNGR_LOAD_TILES",function(e){return r.load(e)})}return e.prototype.loadFromList=function(e){var t,n,r,i,s=this;e==null&&(e="assets/TilesList.list"),Ajax.get("assets/amjad/TilesList.json",function(e){}),log.debug("TileManager loaded tiles."),r=JSON.parse(r),i=[];for(t in r)n=r[t],i.push(this.add(n));return i},e.prototype.load=function(e){var t,n,r;log.debug("Loading tiles..."),log.debug(e),r=[];for(t in e)n=e[t],r.push(this.add(n));return r},e.prototype.add=function(e){return e.id=++this._id,this.TilesByName[e.name]=e,this.TilesByID[e.id]=e},e.prototype.removeByName=function(e){var t;return t=this.TilesByName[e],delete this.TilesByID[t.id],delete this.TilesByName[t.name],t=null},e.prototype.newTileLayer=function(e){return new r(e)},e.prototype.newTileHolder=function(e){return new n(e)},e.prototype.addTileLayerToHolder=function(e,t,n){if(e==null||t==null){log.debug("holder or tile is null");return}return e.addTileLayer(t,n)},e}()})}).call(this);