(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define([],function(){var t;return t=function(){function t(){this.getMousePos=e(this.getMousePos,this),this.mouseDown=e(this.mouseDown,this),this.mouseUp=e(this.mouseUp,this),this.mouseMove=e(this.mouseMove,this),this.mouseClick=e(this.mouseClick,this),this.mouseDblClick=e(this.mouseDblClick,this),this.keyUp=e(this.keyUp,this),this.keyDown=e(this.keyDown,this),this.wheelMoved=e(this.wheelMoved,this),this.viewport=null,this.mouse_leftbtn_down=!1,this.mouse_rightbtn_down=!1,this.can_drag=!0,this.pos=[0,0],this.viewport=Hal.dom.hud,this.dragging=!1,this.under_dom=!1,this.viewport.addEventListener("mousedown",this.mouseDown),this.viewport.addEventListener("mouseup",this.mouseUp),this.viewport.addEventListener("mousemove",this.mouseMove),this.viewport.addEventListener("onmousewheel",this.wheelMoved),this.viewport.addEventListener("onContextMenu",function(){return!1}),this.viewport.addEventListener("mousewheel",this.wheelMoved),this.viewport.addEventListener("click",this.mouseClick),this.viewport.addEventListener("dblclick",this.mouseDblClick),window.addEventListener("keydown",this.keyDown),window.addEventListener("keyup",this.keyUp)}return t.prototype.wheelMoved=function(e){return this.getMousePos(e),Hal.trigger("SCROLL",{down:e.wheelDelta<0,pos:this.pos})},t.prototype.keyDown=function(e){return Hal.trigger("KEY_DOWN",e)},t.prototype.keyUp=function(e){return Hal.trigger("KEY_UP",e)},t.prototype.mouseDblClick=function(e){return this.getMousePos(e),Hal.trigger("LEFT_DBL_CLICK",this.pos)},t.prototype.mouseClick=function(e){if(this.under_dom)return;return this.getMousePos(e),Hal.trigger("MOUSE_CLICK",this.pos)},t.prototype.mouseMove=function(e){this.under_dom=this.viewport.querySelectorAll(":hover").length>0;if(this.under_dom)return;this.getMousePos(e),Hal.trigger("MOUSE_MOVE",this.pos);if(this.mouse_leftbtn_down&&!this.dragging&&this.can_drag)return Hal.trigger("DRAG_STARTED",this.pos),this.dragging=!0,this.can_drag=!1},t.prototype.mouseUp=function(e){if(this.under_dom){this.mouse_leftbtn_down=!1;return}this.getMousePos(e),this.dragging&&(this.dragging=!1,Hal.trigger("DRAG_ENDED",this.pos),this.can_drag=!0);if(this.mouse_rightbtn_down&&!this.dragging)return Hal.trigger("RIGHT_CLICK",this.pos),this.mouse_rightbtn_down=!1;if(this.mouse_leftbtn_down&&!this.dragging)return Hal.trigger("LEFT_CLICK",this.pos),this.mouse_leftbtn_down=!1},t.prototype.mouseDown=function(e){if(this.under_dom){this.mouse_leftbtn_down=!1;return}this.getMousePos(e);if(e.button===0)return this.mouse_leftbtn_down=!0;if(e.button===2)return this.mouse_rightbtn_down=!0},t.prototype.getMousePos=function(e){return this.pos[0]=e.clientX-Hal.dom.area.left,this.pos[1]=e.clientY-Hal.dom.area.top},t}(),t})}).call(this);